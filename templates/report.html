{% extends 'base.html' %}
{% block head %}
<style>
    @media print {
        body {
            -webkit-print-color-adjust: exact;
            font-size: 10pt;
            margin: 0;
            padding: 0;
        }
        .table {
            page-break-inside: avoid;
            margin-left: 0px;
            margin-right: 0px;
            text-align: left;
            font-size: 8pt;
        }
        .table thead {
            display: table-header-group;
            text-align: left;
        }
        .table tbody tr {
            page-break-inside: avoid;
            page-break-after: auto;
            text-align: left;
        }
        .table-responsive {
            overflow: visible;
            text-align: left;
        }
        .btn, .text-center a {
            display: none;
        }
        h1, h2 {
            font-size: 12pt;
        }
    }
</style>
{% endblock %}
{% block content %}
<div class="container mt-5">
    <div class="text-end mb-3">
        <button onclick="window.print()" class="btn btn-primary">Stampa</button>
    </div>
    <h1 class="text-center mb-4 text-primary">Foglio Analitico</h1>
    <div class="table-responsive">
        {% for posizione, consultants in report_data.items() %}
        <h2 class="text-center mt-4">{{ posizione }}</h2>
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th>Consulente</th>
                    <th>Assistenza Giornaliera</th>
                    <th>Assistenza Mensile</th>
                    <th>Dimostrazione Giornaliera</th>
                    <th>Dimostrazione Mensile</th>
                    <th>Vendite Assistenza Giornaliera</th>
                    <th>Vendite Assistenza Mensile</th>
                    <th>Vendite Dimostrazione Giornaliera</th>
                    <th>Vendite Dimostrazione Mensile</th>
                    <th>Nominativi Giornalieri</th>
                    <th>Nominativi Mensili</th>
                    <th>Appuntamenti Personali Giornalieri</th>
                    <th>Appuntamenti Personali Mensili</th>
                    <th>Totale Appuntamenti</th>
                    <th>Vendite di Gruppo</th>
                </tr>
            </thead>
            <tbody>
                {% for data in consultants %}
                <tr>
                    <td>{{ data.consultant }}</td>
                    <td>{{ data.daily_assistance }}</td>
                    <td>{{ data.monthly_assistance }}</td>
                    <td>{{ data.daily_demonstration }}</td>
                    <td>{{ data.monthly_demonstration }}</td>
                    <td>{{ data.daily_sales_assistance }}</td>
                    <td>{{ data.monthly_sales_assistance }}</td>
                    <td>{{ data.daily_sales_demonstration }}</td>
                    <td>{{ data.monthly_sales_demonstration }}</td>
                    <td>{{ data.daily_names }}</td>
                    <td>{{ data.monthly_names }}</td>
                    <td>{{ data.daily_personal_appointments }}</td>
                    <td>{{ data.monthly_personal_appointments }}</td>
                    <td>{{ data.total_appointments }}</td>
                    <td>{{ data.group_sales }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endfor %}
    </div>
    <div class="text-center mt-4">
        <a href="{{ url_for('index') }}" class="btn btn-secondary">Torna alla Home</a>
    </div>
</div>
{% endblock %}